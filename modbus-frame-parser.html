<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Modbus Frame Parser and Decoder | modbus.app</title>
<meta name="description" content="Free online Modbus RTU and TCP frame parser. Decode hex packets, validate CRC, parse function codes and register values instantly.">
<link rel="canonical" href="https://modbus.app/modbus-frame-parser.html" />
<meta property="og:title" content="Modbus Frame Parser and Decoder">
<meta property="og:description" content="Free online Modbus RTU and TCP frame parser. Decode hex packets, validate CRC, parse function codes and register values instantly.">
<meta property="og:url" content="https://modbus.app/modbus-frame-parser.html">
<meta property="og:type" content="website">
<meta property="og:site_name" content="modbus.app">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Outfit:wght@300;400;500;600;700;800&display=swap');
:root{--bg:#0a0e17;--bg-card:#111827;--bg-card-hover:#1a2235;--bg-code:#0d1117;--green:#00e5a0;--green-dim:rgba(0,229,160,0.1);--green-border:rgba(0,229,160,0.2);--red:#ff4d6a;--red-dim:rgba(255,77,106,0.08);--red-border:rgba(255,77,106,0.15);--amber:#f5a623;--amber-dim:rgba(245,166,35,0.08);--amber-border:rgba(245,166,35,0.15);--blue:#4da6ff;--blue-dim:rgba(77,166,255,0.08);--blue-border:rgba(77,166,255,0.15);--purple:#a78bfa;--purple-dim:rgba(167,139,250,0.08);--purple-border:rgba(167,139,250,0.15);--cyan:#22d3ee;--cyan-dim:rgba(34,211,238,0.08);--cyan-border:rgba(34,211,238,0.15);--text:#e2e8f0;--text-dim:#94a3b8;--text-muted:#64748b;--border:rgba(255,255,255,0.06);--font-mono:'JetBrains Mono',monospace;--font-sans:'Outfit',sans-serif}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:var(--font-sans);background:var(--bg);color:var(--text);line-height:1.7;-webkit-font-smoothing:antialiased}.site-nav{position:fixed;top:0;left:0;right:0;z-index:100;background:rgba(10,14,23,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:60px;display:flex;align-items:center;justify-content:center}.nav-inner{max-width:1100px;width:100%;display:flex;align-items:center;justify-content:space-between}.nav-logo{display:flex;align-items:center;gap:0.5rem;text-decoration:none;color:var(--text);font-family:var(--font-mono);font-weight:700;font-size:1.1rem}.nav-logo .dot{color:var(--green)}.nav-links{display:flex;gap:1.5rem;list-style:none}.nav-links a{color:var(--text-dim);text-decoration:none;font-size:0.9rem;font-weight:500;transition:color 0.2s}.nav-links a:hover,.nav-links a.active{color:var(--green)}.nav-cta{background:var(--green);color:#0a0e17;padding:0.5rem 1.2rem;border-radius:6px;text-decoration:none;font-weight:600;font-size:0.85rem;transition:all 0.2s}.nav-cta:hover{transform:translateY(-1px);box-shadow:0 4px 20px rgba(0,229,160,0.3)}.nav-dropdown{position:relative}.nav-dropdown>a{cursor:pointer}.nav-dropdown>a::after{content:" \25BE";font-size:0.7em}.nav-dropdown-menu{display:none;position:absolute;top:100%;left:50%;transform:translateX(-50%);background:var(--bg-card);border:1px solid var(--border);border-radius:8px;padding:0.5rem 0;padding-top:1rem;min-width:200px;box-shadow:0 8px 30px rgba(0,0,0,0.3);margin-top:0;z-index:200}.nav-dropdown::after{content:'';position:absolute;top:100%;left:0;right:0;height:12px}.nav-dropdown:hover .nav-dropdown-menu{display:block}.nav-dropdown-menu a{display:block;padding:0.5rem 1rem;color:var(--text-dim);text-decoration:none;font-size:0.85rem;font-weight:500;transition:all 0.2s;white-space:nowrap}.nav-dropdown-menu a:hover{color:var(--green);background:rgba(0,229,160,0.05)}.guide-hero{padding:8rem 2rem 3rem;max-width:960px;margin:0 auto;border-bottom:1px solid var(--border)}.guide-hero .breadcrumb{font-family:var(--font-mono);font-size:0.8rem;color:var(--text-muted);margin-bottom:1.5rem}.guide-hero .breadcrumb a{color:var(--green);text-decoration:none}.guide-hero h1{font-size:clamp(2rem,5vw,2.8rem);font-weight:800;line-height:1.15;margin-bottom:1rem;background:linear-gradient(135deg,var(--text) 0%,var(--text-dim) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.guide-hero .subtitle{font-size:1.1rem;color:var(--text-dim);max-width:640px;line-height:1.6}.tool-main{max-width:960px;margin:0 auto;padding:2rem 2rem 4rem}.input-section{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem}.field-label{display:block;font-size:0.75rem;font-weight:600;color:var(--text-muted);margin-bottom:0.4rem;font-family:var(--font-mono);text-transform:uppercase;letter-spacing:0.05em}.hex-input{width:100%;background:var(--bg-code);border:1px solid var(--border);border-radius:8px;padding:0.7rem 1rem;font-family:var(--font-mono);font-size:1rem;color:var(--text);outline:none;transition:border-color 0.2s;resize:vertical;min-height:48px}.hex-input:focus{border-color:var(--green);box-shadow:0 0 0 3px rgba(0,229,160,0.1)}.hex-input::placeholder{color:var(--text-muted);font-size:0.9rem}.input-options{display:flex;gap:1.5rem;align-items:center;margin-top:0.75rem;flex-wrap:wrap}.radio-group{display:flex;gap:1rem;align-items:center}.radio-group label{display:flex;align-items:center;gap:0.35rem;font-size:0.85rem;color:var(--text-dim);cursor:pointer;font-family:var(--font-mono);font-weight:500}.radio-group input[type="radio"]{accent-color:var(--green);width:14px;height:14px}.examples-row{display:flex;gap:0.5rem;flex-wrap:wrap;margin-top:0.75rem}.example-btn{background:var(--bg-code);border:1px solid var(--border);border-radius:6px;padding:0.3rem 0.7rem;font-family:var(--font-mono);font-size:0.72rem;color:var(--text-dim);cursor:pointer;transition:all 0.2s}.example-btn:hover{border-color:var(--green-border);color:var(--green);background:var(--green-dim)}.example-label{font-size:0.72rem;color:var(--text-muted);font-family:var(--font-mono);font-weight:600;text-transform:uppercase;letter-spacing:0.04em;align-self:center}.byte-vis{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:1.5rem;min-height:10px;align-items:center}.byte-box{display:inline-flex;align-items:center;justify-content:center;width:38px;height:38px;border-radius:6px;font-family:var(--font-mono);font-size:0.8rem;font-weight:600;border:1px solid}.byte-slave{background:var(--blue-dim);border-color:var(--blue-border);color:var(--blue)}.byte-fc{background:var(--green-dim);border-color:var(--green-border);color:var(--green)}.byte-data{background:var(--purple-dim);border-color:var(--purple-border);color:var(--purple)}.byte-crc{background:var(--red-dim);border-color:var(--red-border);color:var(--red)}.byte-tid{background:var(--cyan-dim);border-color:var(--cyan-border);color:var(--cyan)}.byte-proto,.byte-len{background:var(--amber-dim);border-color:var(--amber-border);color:var(--amber)}.byte-uid{background:var(--blue-dim);border-color:var(--blue-border);color:var(--blue)}.result-card{background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:1.25rem;margin-bottom:1rem;transition:border-color 0.2s}.result-card:hover{border-color:rgba(255,255,255,0.1)}.result-card h3{display:flex;align-items:center;gap:0.5rem;font-size:0.85rem;font-weight:700;color:var(--text);margin-bottom:0.75rem;padding-bottom:0.6rem;border-bottom:1px solid var(--border)}.card-icon{display:inline-flex;align-items:center;justify-content:center;width:24px;height:24px;border-radius:5px;font-size:0.6rem;font-weight:700;font-family:var(--font-mono);flex-shrink:0}.card-icon.frame{background:var(--green-dim);color:var(--green);border:1px solid var(--green-border)}.card-icon.data{background:var(--purple-dim);color:var(--purple);border:1px solid var(--purple-border)}.result-table{width:100%;border-collapse:collapse;font-size:0.82rem}.result-table td{padding:0.4rem 0.5rem;border-bottom:1px solid var(--border);vertical-align:middle}.result-table td:first-child{color:var(--text-muted);font-size:0.75rem;font-weight:600;font-family:var(--font-mono);text-transform:uppercase;letter-spacing:0.03em;white-space:nowrap;width:30%}.result-table td:nth-child(2){font-family:var(--font-mono);font-size:0.85rem;color:var(--green);width:18%}.result-table td:nth-child(3){font-family:var(--font-mono);font-size:0.85rem;color:var(--text-dim);width:12%}.result-table td:last-child{color:var(--text);font-size:0.82rem}.result-table tr:last-child td{border-bottom:none}.status-badge{display:inline-block;padding:0.15rem 0.6rem;border-radius:4px;font-size:0.72rem;font-weight:600;font-family:var(--font-mono)}.badge-rtu{background:var(--blue-dim);color:var(--blue);border:1px solid var(--blue-border)}.badge-tcp{background:var(--green-dim);color:var(--green);border:1px solid var(--green-border)}.badge-valid{background:var(--green-dim);color:var(--green);border:1px solid var(--green-border)}.badge-invalid{background:var(--red-dim);color:var(--red);border:1px solid var(--red-border)}.no-data{color:var(--text-muted);font-style:italic;text-align:center;padding:2rem;font-size:0.9rem}.legend{display:flex;gap:1rem;flex-wrap:wrap;margin-bottom:1rem;font-size:0.72rem;font-family:var(--font-mono)}.legend-item{display:flex;align-items:center;gap:0.3rem;color:var(--text-dim)}.legend-swatch{width:12px;height:12px;border-radius:3px;border:1px solid}.app-promo{background:linear-gradient(135deg,rgba(0,229,160,0.08) 0%,rgba(0,229,160,0.02) 100%);border:1px solid var(--green-border);border-radius:12px;padding:2rem;margin:2.5rem 0;text-align:center}.app-promo h4{color:var(--green);margin-bottom:0.5rem}.app-promo p{color:var(--text-dim);max-width:540px;margin:0 auto 1.25rem}.app-promo .app-promo-badge{display:inline-block;background:var(--green-dim);color:var(--green);padding:0.2rem 0.8rem;border-radius:4px;font-size:0.8rem;font-weight:600;margin-bottom:0.75rem;border:1px solid var(--green-border)}.app-promo .app-promo-cta{display:inline-block;background:var(--green);color:#0a0e17;padding:0.65rem 1.8rem;border-radius:6px;font-weight:700;text-decoration:none;transition:all 0.2s}.app-promo .app-promo-cta:hover{transform:translateY(-2px);box-shadow:0 4px 20px rgba(0,229,160,0.3)}.seo-content{margin-top:3rem;padding-top:2rem;border-top:1px solid var(--border)}.seo-content h2{font-size:1.3rem;font-weight:700;margin-bottom:1rem;color:var(--text)}.seo-content h3{font-size:1.05rem;font-weight:600;margin:1.5rem 0 0.5rem;color:var(--text)}.seo-content p{color:var(--text-dim);font-size:0.95rem;margin-bottom:1rem;line-height:1.7}
@media(max-width:768px){.site-nav{padding:0 1rem}.nav-links{display:none}.guide-hero{padding:6rem 1rem 2rem}.tool-main{padding:1.5rem 1rem 3rem}.input-options{flex-direction:column;gap:0.75rem}.byte-box{width:32px;height:32px;font-size:0.7rem}}
</style>
<script type="application/ld+json">{"@context":"https://schema.org","@type":"WebApplication","name":"Modbus Frame Parser","url":"https://modbus.app/modbus-frame-parser.html","applicationCategory":"UtilitiesApplication","operatingSystem":"Any","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}}</script>
</head>
<body>
<nav class="site-nav"><div class="nav-inner"><a href="index.html" class="nav-logo">modbus<span class="dot">.</span>app</a><ul class="nav-links"><li><a href="index.html">Product</a></li><li class="nav-dropdown"><a href="#" class="active">Tools</a><div class="nav-dropdown-menu"><a href="number-converter.html">Number Converter</a><a href="modbus-frame-parser.html">Frame Parser</a><a href="modbus-address-calculator.html">Address Calculator</a><a href="modbus-baud-rate-calculator.html">Baud Rate Calculator</a></div></li><li><a href="read-modbus-data.html">Guides</a></li><li><a href="guides.html">Troubleshooting</a></li><li><a href="pricing.html">Pricing</a></li><li><a href="contact.html">Contact</a></li></ul><a href="index.html#download" class="nav-cta">Download Free</a></div></nav>
<div class="guide-hero"><div class="breadcrumb"><a href="index.html">Home</a> / <a href="guides.html">Tools</a> / Frame Parser</div><h1>Modbus Frame Parser &amp; Decoder</h1><p class="subtitle">Paste a Modbus RTU or TCP hex frame and instantly decode every byte. Validates CRC-16, parses function codes, and extracts register values.</p></div>
<div class="tool-main">
<div class="input-section"><label class="field-label">Hex Frame</label><textarea class="hex-input" id="hexInput" rows="2" placeholder="e.g. 01 03 00 00 00 0A C5 CD" autocomplete="off" spellcheck="false"></textarea><div class="input-options"><div class="radio-group"><span class="example-label">Protocol:</span><label><input type="radio" name="proto" value="auto" checked> Auto-detect</label><label><input type="radio" name="proto" value="rtu"> Modbus RTU</label><label><input type="radio" name="proto" value="tcp"> Modbus TCP</label></div></div><div class="examples-row"><span class="example-label">Try:</span><button class="example-btn" onclick="loadExample('01 03 00 00 00 0A C5 CD')">FC03 Read Request</button><button class="example-btn" onclick="loadExample('01 03 14 00 01 00 02 00 03 00 04 00 05 00 06 00 07 00 08 00 09 00 0A 07 4C')">FC03 Response</button><button class="example-btn" onclick="loadExample('01 01 00 00 00 08 3D CC')">FC01 Read Coils</button><button class="example-btn" onclick="loadExample('01 05 00 64 FF 00 CD E5')">FC05 Write Coil</button><button class="example-btn" onclick="loadExample('01 06 00 01 00 03 98 0B')">FC06 Write Reg</button><button class="example-btn" onclick="loadExample('01 10 00 01 00 02 04 00 0A 01 02 A1 62')">FC16 Write Multi</button><button class="example-btn" onclick="loadExample('00 01 00 00 00 06 01 03 00 00 00 0A')">TCP Request</button><button class="example-btn" onclick="loadExample('00 01 00 00 00 17 01 03 14 00 01 00 02 00 03 00 04 00 05 00 06 00 07 00 08 00 09 00 0A')">TCP Response</button></div></div>
<div class="legend" id="legend" style="display:none"><div class="legend-item"><div class="legend-swatch" style="background:var(--blue-dim);border-color:var(--blue-border)"></div> Slave/Unit ID</div><div class="legend-item"><div class="legend-swatch" style="background:var(--green-dim);border-color:var(--green-border)"></div> Function Code</div><div class="legend-item"><div class="legend-swatch" style="background:var(--purple-dim);border-color:var(--purple-border)"></div> Data</div><div class="legend-item"><div class="legend-swatch" style="background:var(--red-dim);border-color:var(--red-border)"></div> CRC-16</div><div class="legend-item"><div class="legend-swatch" style="background:var(--cyan-dim);border-color:var(--cyan-border)"></div> Transaction/Protocol</div><div class="legend-item"><div class="legend-swatch" style="background:var(--amber-dim);border-color:var(--amber-border)"></div> Length</div></div>
<div class="byte-vis" id="byteVis"></div><div id="results"></div>
<div class="app-promo"><div class="app-promo-badge">Live Frame Capture</div><h4>Need to test this live? Download ModBus Pro &mdash; free 7-day trial</h4><p>Monitor and decode Modbus frames in real-time from your serial port or TCP connection. Built-in request builder, auto-CRC, and frame history.</p><a href="index.html#download" class="app-promo-cta">Download Free Trial</a></div>
<div class="seo-content"><h2>Understanding Modbus Frame Structure</h2><p>Modbus is one of the most widely deployed industrial communication protocols, connecting PLCs, sensors, VFDs, energy meters, and thousands of other devices across factory floors, power plants, and building automation systems worldwide. At the heart of every Modbus exchange is a structured frame, a sequence of bytes that carries a request from a master (client) to a slave (server) and brings back a response. Understanding how these frames are constructed is essential for anyone commissioning, troubleshooting, or reverse-engineering Modbus networks.</p><h3>Modbus RTU Frames</h3><p>In Modbus RTU mode, data is transmitted over a serial line (RS-232 or RS-485) as a compact binary frame. Every RTU frame begins with the Slave Address, a single byte identifying which device on the bus should respond (1 to 247 for unicast, 0 for broadcast). Next comes the Function Code byte, which tells the slave what operation to perform: read coils (FC01), read discrete inputs (FC02), read holding registers (FC03), read input registers (FC04), write a single coil (FC05), write a single register (FC06), write multiple coils (FC15), or write multiple registers (FC16). The data field that follows is variable-length and depends entirely on the function code.</p><p>The final two bytes of every RTU frame are the CRC-16 checksum, calculated over all preceding bytes using the polynomial 0xA001. The CRC is transmitted in little-endian order (low byte first, high byte second). If even a single bit is corrupted during transmission, the CRC will fail, and the slave discards the frame silently. This is one of the most common sources of communication errors in noisy industrial environments.</p><h3>Modbus TCP Frames</h3><p>Modbus TCP wraps the same PDU inside a TCP/IP packet with a 7-byte MBAP header. The header begins with a 2-byte Transaction Identifier for matching responses to requests. Next comes the 2-byte Protocol Identifier (always 0x0000 for standard Modbus). The Length field (2 bytes) specifies how many bytes follow. The Unit Identifier (1 byte) serves the same role as the RTU Slave Address. Modbus TCP does not use a CRC since TCP provides its own error checking.</p><h3>Parsing Function Code Data</h3><p>The data field interpretation depends on whether the frame is a request or response and which function code is used. For FC01-FC04 requests, the data is always 4 bytes: a 2-byte starting address and a 2-byte quantity. For FC01/FC02 responses, the data begins with a byte count followed by packed coil bits. For FC03/FC04 responses, the byte count is followed by 16-bit register values in big-endian order. FC05 uses 0xFF00 for ON and 0x0000 for OFF. FC06 carries address and value. FC15 and FC16 carry starting address, quantity, byte count, and values.</p><h3>How This Tool Helps</h3><p>This parser accepts raw hex bytes in any common format (space-separated, comma-separated, continuous hex string, or 0x-prefixed), auto-detects whether the frame is RTU or TCP, and decodes every field with color-coded byte visualization. For RTU frames it calculates and validates the CRC-16. For TCP frames it extracts the full MBAP header. Paste a logic analyzer capture or Wireshark hex dump here and get an instant readable decode.</p></div></div>
<footer style="border-top:1px solid rgba(255,255,255,0.06);padding:4rem 0 2rem;margin-top:6rem"><div style="max-width:1200px;margin:0 auto;padding:0 2rem"><div style="display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:3rem;margin-bottom:3rem"><div><div style="display:flex;align-items:center;gap:0.75rem;margin-bottom:1rem"><div style="width:32px;height:32px;background:linear-gradient(135deg,#00e5a0,#00c488);border-radius:8px;display:flex;align-items:center;justify-content:center"><svg width="18" height="18" fill="none" stroke="#0a0e17" stroke-width="2.5" stroke-linecap="round"><path d="M3 9h12M9 3v12"/></svg></div><span style="font-weight:700;font-size:1.1rem">ModBus Pro</span></div><p style="color:var(--text-muted);font-size:0.9rem;line-height:1.6;max-width:280px">The modern Modbus diagnostic tool. Built for engineers who need reliability.</p></div><div><h4 style="font-size:0.8rem;text-transform:uppercase;letter-spacing:0.1em;color:var(--text-muted);margin-bottom:1rem">Product</h4><ul style="list-style:none;padding:0;display:flex;flex-direction:column;gap:0.6rem"><li><a href="index.html" style="color:var(--text-dim);text-decoration:none;font-size:0.9rem">Features</a></li><li><a href="pricing.html" style="color:var(--text-dim);text-decoration:none;font-size:0.9rem">Pricing</a></li><li><a href="number-converter.html" style="color:var(--text-dim);text-decoration:none;font-size:0.9rem">Number Converter</a></li><li><a href="modbus-frame-parser.html" style="color:var(--text-dim);text-decoration:none;font-size:0.9rem">Frame Parser</a></li></ul></div><div><h4 style="font-size:0.8rem;text-transform:uppercase;letter-spacing:0.1em;color:var(--text-muted);margin-bottom:1rem">Resources</h4><ul style="list-style:none;padding:0;display:flex;flex-direction:column;gap:0.6rem"><li><a href="guides.html" style="color:var(--text-dim);text-decoration:none;font-size:0.9rem">Guides</a></li><li><a href="modbus-address-calculator.html" style="color:var(--text-dim);text-decoration:none;font-size:0.9rem">Address Calculator</a></li><li><a href="modbus-baud-rate-calculator.html" style="color:var(--text-dim);text-decoration:none;font-size:0.9rem">Baud Rate Calculator</a></li><li><a href="mailto:support@modbus.app" style="color:var(--text-dim);text-decoration:none;font-size:0.9rem">Support</a></li></ul></div><div><h4 style="font-size:0.8rem;text-transform:uppercase;letter-spacing:0.1em;color:var(--text-muted);margin-bottom:1rem">Legal</h4><ul style="list-style:none;padding:0;display:flex;flex-direction:column;gap:0.6rem"><li><a href="#" style="color:var(--text-dim);text-decoration:none;font-size:0.9rem">Privacy</a></li><li><a href="terms.html" style="color:var(--text-dim);text-decoration:none;font-size:0.9rem">Terms</a></li></ul></div></div><div style="border-top:1px solid rgba(255,255,255,0.06);padding-top:1.5rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem"><p style="color:var(--text-muted);font-size:0.8rem">&copy; 2026 modbus.app</p><p style="color:#5a6478;font-size:0.65rem">Modbus&reg; is a registered trademark of Schneider Electric. ModBus Pro is not affiliated with or endorsed by Schneider Electric or the Modbus Organization.</p><a href="mailto:support@modbus.app" style="color:var(--text-muted);text-decoration:none;font-size:0.8rem">support@modbus.app</a></div></div></footer>
<script>
(function(){'use strict';var hexInput=document.getElementById('hexInput'),byteVis=document.getElementById('byteVis'),legend=document.getElementById('legend'),resultsDiv=document.getElementById('results');function getProtoMode(){var r=document.querySelectorAll('input[name="proto"]');for(var i=0;i<r.length;i++)if(r[i].checked)return r[i].value;return'auto';}function parseHexString(raw){raw=raw.trim();if(!raw)return[];raw=raw.replace(/0x/gi,'').replace(/[,;]/g,' ').replace(/\s+/g,' ').trim();if(raw.indexOf(' ')===-1&&raw.length>=2&&raw.length%2===0){var p=[];for(var i=0;i<raw.length;i+=2)p.push(raw.substr(i,2));raw=p.join(' ');}var parts=raw.split(' '),bytes=[];for(var i=0;i<parts.length;i++){if(!/^[0-9a-fA-F]{1,2}$/.test(parts[i]))return null;bytes.push(parseInt(parts[i],16));}return bytes;}function toHex2(v){var s=(v&0xFF).toString(16).toUpperCase();return s.length<2?'0'+s:s;}function toHex4(v){var s=(v&0xFFFF).toString(16).toUpperCase();while(s.length<4)s='0'+s;return s;}function modbusCRC16(data){var crc=0xFFFF;for(var i=0;i<data.length;i++){crc^=data[i];for(var j=0;j<8;j++){if(crc&1)crc=(crc>>>1)^0xA001;else crc=crc>>>1;}}return crc&0xFFFF;}function detectProtocol(bytes){var m=getProtoMode();if(m==='rtu')return'rtu';if(m==='tcp')return'tcp';if(bytes.length>=7){var pid=(bytes[2]<<8)|bytes[3],ml=(bytes[4]<<8)|bytes[5];if(pid===0&&ml===bytes.length-6&&ml>=2)return'tcp';}return'rtu';}function getFCName(fc){var n={1:'Read Coils',2:'Read Discrete Inputs',3:'Read Holding Registers',4:'Read Input Registers',5:'Write Single Coil',6:'Write Single Register',15:'Write Multiple Coils',16:'Write Multiple Registers',23:'Read/Write Multiple Registers'};if(fc>128)return'Exception (FC'+(fc-128)+')';return n[fc]||'FC'+fc;}function getExcName(c){var n={1:'Illegal Function',2:'Illegal Data Address',3:'Illegal Data Value',4:'Slave Device Failure',5:'Acknowledge',6:'Slave Device Busy'};return n[c]||'Exception '+c;}function isReq(bytes,fi,proto){var fc=bytes[fi];if(fc>128)return false;if(fc>=1&&fc<=4){var dl=bytes.length-fi-1;if(proto==='rtu')dl-=2;return dl===4;}if(fc===5||fc===6)return true;if(fc===15||fc===16){var dl2=bytes.length-fi-1;if(proto==='rtu')dl2-=2;return dl2>4;}return true;}function parseData(bytes,fi,ds,de){var fc=bytes[fi],rows=[],proto=detectProtocol(bytes);if(fc>128){if(ds<de)rows.push({f:'Exception Code',h:'0x'+toHex2(bytes[ds]),d:bytes[ds],desc:getExcName(bytes[ds])});return rows;}var req=isReq(bytes,fi,proto);if(fc>=1&&fc<=4){if(req){if(de-ds>=4){var sa=(bytes[ds]<<8)|bytes[ds+1],qty=(bytes[ds+2]<<8)|bytes[ds+3];rows.push({f:'Start Address',h:'0x'+toHex4(sa),d:sa,desc:'0-based: '+sa+', 1-based: '+(sa+1)});rows.push({f:'Quantity',h:'0x'+toHex4(qty),d:qty,desc:qty+(fc<=2?' coils/inputs':' registers')});}}else{if(ds<de){var bc=bytes[ds];rows.push({f:'Byte Count',h:'0x'+toHex2(bc),d:bc,desc:bc+' bytes'});if(fc<=2){var vs=[];for(var b=ds+1;b<de&&b<ds+1+bc;b++)vs.push('0x'+toHex2(bytes[b]));rows.push({f:'Coil Data',h:vs.join(' '),d:'',desc:'Packed bits (LSB first)'});}else{var rc=Math.floor(bc/2);for(var r=0;r<rc&&(ds+1+r*2+1)<de;r++){var rv=(bytes[ds+1+r*2]<<8)|bytes[ds+1+r*2+1];rows.push({f:'Register '+r,h:'0x'+toHex4(rv),d:rv,desc:'Signed: '+(rv>32767?rv-65536:rv)});}}}}}else if(fc===5){if(de-ds>=4){var a=(bytes[ds]<<8)|bytes[ds+1],v=(bytes[ds+2]<<8)|bytes[ds+3];rows.push({f:'Coil Address',h:'0x'+toHex4(a),d:a,desc:'0-based: '+a+', 1-based: '+(a+1)});rows.push({f:'Value',h:'0x'+toHex4(v),d:v,desc:v===0xFF00?'ON':v===0?'OFF':'Unknown'});}}else if(fc===6){if(de-ds>=4){var a=(bytes[ds]<<8)|bytes[ds+1],v=(bytes[ds+2]<<8)|bytes[ds+3];rows.push({f:'Register Address',h:'0x'+toHex4(a),d:a,desc:'0-based: '+a+', 1-based: '+(a+1)});rows.push({f:'Value',h:'0x'+toHex4(v),d:v,desc:'Signed: '+(v>32767?v-65536:v)});}}else if(fc===15||fc===16){if(req&&de-ds>=5){var a=(bytes[ds]<<8)|bytes[ds+1],q=(bytes[ds+2]<<8)|bytes[ds+3],bc2=bytes[ds+4];rows.push({f:'Start Address',h:'0x'+toHex4(a),d:a,desc:'0-based: '+a+', 1-based: '+(a+1)});rows.push({f:'Quantity',h:'0x'+toHex4(q),d:q,desc:q+(fc===15?' coils':' registers')});rows.push({f:'Byte Count',h:'0x'+toHex2(bc2),d:bc2,desc:bc2+' bytes'});if(fc===16){for(var w=0;w<q&&(ds+5+w*2+1)<de;w++){var wv=(bytes[ds+5+w*2]<<8)|bytes[ds+5+w*2+1];rows.push({f:'Register '+w,h:'0x'+toHex4(wv),d:wv,desc:'Value to write'});}}else{var cv=[];for(var c=ds+5;c<de;c++)cv.push('0x'+toHex2(bytes[c]));if(cv.length)rows.push({f:'Coil Values',h:cv.join(' '),d:'',desc:'Packed bits'});}}else if(de-ds>=4){var a=(bytes[ds]<<8)|bytes[ds+1],q=(bytes[ds+2]<<8)|bytes[ds+3];rows.push({f:'Start Address',h:'0x'+toHex4(a),d:a,desc:'Echo'});rows.push({f:'Quantity',h:'0x'+toHex4(q),d:q,desc:q+' written'});}}else{for(var g=ds;g<de;g++)rows.push({f:'Data['+(g-ds)+']',h:'0x'+toHex2(bytes[g]),d:bytes[g],desc:''});}return rows;}function buildTable(rows){if(!rows.length)return'';var h='<table class="result-table">';for(var i=0;i<rows.length;i++)h+='<tr><td>'+rows[i].f+'</td><td>'+rows[i].h+'</td><td>'+(rows[i].d!==''?rows[i].d:'')+'</td><td>'+rows[i].desc+'</td></tr>';return h+'</table>';}function parse(){var bytes=parseHexString(hexInput.value);if(!bytes||!bytes.length){byteVis.innerHTML='';legend.style.display='none';resultsDiv.innerHTML='<div class="no-data">Enter a hex frame above to decode it</div>';return;}if(bytes.length<3){byteVis.innerHTML='';legend.style.display='none';resultsDiv.innerHTML='<div class="no-data">Frame too short (min 3 bytes)</div>';return;}var proto=detectProtocol(bytes);legend.style.display='flex';var vis='',fr=[],dr=[];if(proto==='tcp'){if(bytes.length<7){resultsDiv.innerHTML='<div class="no-data">TCP frame too short</div>';return;}var tid=(bytes[0]<<8)|bytes[1],pid=(bytes[2]<<8)|bytes[3],ml=(bytes[4]<<8)|bytes[5],uid=bytes[6];vis+='<div class="byte-box byte-tid">'+toHex2(bytes[0])+'</div><div class="byte-box byte-tid">'+toHex2(bytes[1])+'</div><div class="byte-box byte-proto">'+toHex2(bytes[2])+'</div><div class="byte-box byte-proto">'+toHex2(bytes[3])+'</div><div class="byte-box byte-len">'+toHex2(bytes[4])+'</div><div class="byte-box byte-len">'+toHex2(bytes[5])+'</div><div class="byte-box byte-uid">'+toHex2(bytes[6])+'</div>';if(bytes.length>7)vis+='<div class="byte-box byte-fc">'+toHex2(bytes[7])+'</div>';for(var i=8;i<bytes.length;i++)vis+='<div class="byte-box byte-data">'+toHex2(bytes[i])+'</div>';fr.push({f:'Protocol',h:'',d:'',desc:'<span class="status-badge badge-tcp">Modbus TCP</span>'});fr.push({f:'Transaction ID',h:'0x'+toHex4(tid),d:tid,desc:'Request/response matching'});fr.push({f:'Protocol ID',h:'0x'+toHex4(pid),d:pid,desc:pid===0?'Modbus protocol':'Non-standard'});fr.push({f:'Length',h:'0x'+toHex4(ml),d:ml,desc:ml+' bytes following'});fr.push({f:'Unit ID',h:'0x'+toHex2(uid),d:uid,desc:'Unit identifier'});if(bytes.length>7){var fc=bytes[7],exc=fc>128;fr.push({f:'Function Code',h:'0x'+toHex2(fc),d:fc,desc:getFCName(fc)+(exc?' <span class="status-badge badge-invalid">ERROR</span>':'')});var rq=isReq(bytes,7,proto);fr.push({f:'Direction',h:'',d:'',desc:exc?'Exception response':(rq?'Request':'Response')});}dr=parseData(bytes,7,8,bytes.length);}else{var sid=bytes[0],fc=bytes[1],de=bytes.length-2,clo=bytes[bytes.length-2],chi=bytes[bytes.length-1],fcrc=(chi<<8)|clo,ccrc=modbusCRC16(bytes.slice(0,bytes.length-2)),cclo=ccrc&0xFF,cchi=(ccrc>>>8)&0xFF,ok=fcrc===ccrc;vis+='<div class="byte-box byte-slave">'+toHex2(bytes[0])+'</div><div class="byte-box byte-fc">'+toHex2(bytes[1])+'</div>';for(var i=2;i<bytes.length-2;i++)vis+='<div class="byte-box byte-data">'+toHex2(bytes[i])+'</div>';vis+='<div class="byte-box byte-crc">'+toHex2(clo)+'</div><div class="byte-box byte-crc">'+toHex2(chi)+'</div>';var exc=fc>128;fr.push({f:'Protocol',h:'',d:'',desc:'<span class="status-badge badge-rtu">Modbus RTU</span>'});fr.push({f:'Slave ID',h:'0x'+toHex2(sid),d:sid,desc:sid===0?'Broadcast':'Device '+sid});fr.push({f:'Function Code',h:'0x'+toHex2(fc),d:fc,desc:getFCName(fc)+(exc?' <span class="status-badge badge-invalid">ERROR</span>':'')});var rq=isReq(bytes,1,proto);fr.push({f:'Direction',h:'',d:'',desc:exc?'Exception response':(rq?'Request':'Response')});fr.push({f:'Data Length',h:'',d:de-2,desc:(de-2)+' bytes'});fr.push({f:'CRC-16 (received)',h:'0x'+toHex2(clo)+toHex2(chi),d:fcrc,desc:'Lo: 0x'+toHex2(clo)+' Hi: 0x'+toHex2(chi)});fr.push({f:'CRC-16 (calculated)',h:'0x'+toHex2(cclo)+toHex2(cchi),d:ccrc,desc:ok?'<span class="status-badge badge-valid">VALID</span>':'<span class="status-badge badge-invalid">INVALID</span> Expected 0x'+toHex2(cclo)+toHex2(cchi)});dr=parseData(bytes,1,2,de);}byteVis.innerHTML=vis;var out='<div class="result-card"><h3><span class="card-icon frame">FR</span> Frame Header</h3>'+buildTable(fr)+'</div>';if(dr.length)out+='<div class="result-card"><h3><span class="card-icon data">DA</span> Data Fields</h3>'+buildTable(dr)+'</div>';resultsDiv.innerHTML=out;}hexInput.addEventListener('input',parse);var radios=document.querySelectorAll('input[name="proto"]');for(var r=0;r<radios.length;r++)radios[r].addEventListener('change',parse);window.loadExample=function(hex){hexInput.value=hex;parse();};resultsDiv.innerHTML='<div class="no-data">Enter a hex frame above to decode it</div>';})();
</script>
</body>
</html>
